# ê²Œì„ ì„œë¹„ìŠ¤ ì¸ì‹œë˜íŠ¸ ê´€ë¦¬ ì •ì±…
# SRE íŒ€ì˜ í‘œì¤€í™”ëœ ì¸ì‹œë˜íŠ¸ ëŒ€ì‘ ì²´ê³„

apiVersion: sre.observaility.com/v1
kind: IncidentManagementPolicy
metadata:
  name: game-service-incident-policy
  namespace: game-sre
  labels:
    service: game-service
    team: game-sre
    environment: production
spec:
  description: "ëª¨ë°”ì¼ ê²Œì„ ì„œë¹„ìŠ¤ ì¸ì‹œë˜íŠ¸ ëŒ€ì‘ í‘œì¤€ ì •ì±…"

  # ì¸ì‹œë˜íŠ¸ ì‹¬ê°ë„ ì •ì˜
  severityLevels:
    - level: "Sev0"
      name: "ì „ë©´ ì¤‘ë‹¨"
      description: "ê²Œì„ ì„œë¹„ìŠ¤ ì „ì²´ê°€ ì‚¬ìš© ë¶ˆê°€ëŠ¥í•œ ìƒíƒœ"
      sla:
        mttd: "1ë¶„"
        mttr: "15ë¶„"
        escalation: "ì¦‰ì‹œ"
      impact:
        users: "100%"
        revenue: "ì§ì ‘ì  ì†ì‹¤"
        reputation: "ì‹¬ê°í•œ ì†ìƒ"
      examples:
        - "ê²Œì„ ì„œë²„ ì „ì²´ ë‹¤ìš´"
        - "ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì™„ì „ ì°¨ë‹¨"
        - "ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ ì¥ì• "

    - level: "Sev1"
      name: "í•µì‹¬ ê¸°ëŠ¥ ì¥ì• "
      description: "ê²Œì„ í”Œë ˆì´ì— í•„ìˆ˜ì ì¸ ê¸°ëŠ¥ì´ ì‘ë™í•˜ì§€ ì•ŠëŠ” ìƒíƒœ"
      sla:
        mttd: "5ë¶„"
        mttr: "30ë¶„"
        escalation: "5ë¶„ ë‚´"
      impact:
        users: "50-80%"
        revenue: "ì¤‘ê°„ ì†ì‹¤"
        reputation: "ì¤‘ê°„ ì†ìƒ"
      examples:
        - "ê²Œì„ ë§¤ì¹­ ì‹œìŠ¤í…œ ì¥ì• "
        - "ê²°ì œ ì‹œìŠ¤í…œ ì˜¤ë¥˜"
        - "ê²Œì„ ë°ì´í„° ì €ì¥ ì‹¤íŒ¨"

    - level: "Sev2"
      name: "ë¶€ë¶„ ê¸°ëŠ¥ ì¥ì• "
      description: "ê²Œì„ í”Œë ˆì´ì— ì˜í–¥ì„ ì£¼ì§€ë§Œ ìš°íšŒ ê°€ëŠ¥í•œ ê¸°ëŠ¥ ì¥ì• "
      sla:
        mttd: "15ë¶„"
        mttr: "2ì‹œê°„"
        escalation: "30ë¶„ ë‚´"
      impact:
        users: "20-50%"
        revenue: "ê²½ë¯¸í•œ ì†ì‹¤"
        reputation: "ê²½ë¯¸í•œ ì†ìƒ"
      examples:
        - "ì¹œêµ¬ ëª©ë¡ ë¡œë”© ì‹¤íŒ¨"
        - "ë¦¬ë”ë³´ë“œ í‘œì‹œ ì˜¤ë¥˜"
        - "ì•Œë¦¼ ì‹œìŠ¤í…œ ì¥ì• "

    - level: "Sev3"
      name: "ì„±ëŠ¥ ì €í•˜"
      description: "ê²Œì„ í”Œë ˆì´ ê°€ëŠ¥í•˜ì§€ë§Œ ì„±ëŠ¥ì´ ì €í•˜ëœ ìƒíƒœ"
      sla:
        mttd: "30ë¶„"
        mttr: "4ì‹œê°„"
        escalation: "1ì‹œê°„ ë‚´"
      impact:
        users: "10-30%"
        revenue: "ë¯¸ë¯¸í•œ ì†ì‹¤"
        reputation: "ê±°ì˜ ì˜í–¥ ì—†ìŒ"
      examples:
        - "ê²Œì„ ë¡œë”© ì‹œê°„ ì¦ê°€"
        - "ì‘ë‹µ ì§€ì—° ë°œìƒ"
        - "ì¼ë¶€ UI ë Œë”ë§ ì§€ì—°"

  # ì˜¨ì½œ ë¡œí…Œì´ì…˜ ì •ì±…
  oncallRotation:
    primary:
      duration: "1ì£¼"
      handover: "ì›”ìš”ì¼ ì˜¤ì „ 9ì‹œ"
      backup: "2ëª…"

    secondary:
      duration: "1ì£¼"
      handover: "ì›”ìš”ì¼ ì˜¤ì „ 9ì‹œ"
      backup: "1ëª…"

    escalation:
      - level: "1ì°¨"
        contact: "primary-oncall"
        timeout: "5ë¶„"
      - level: "2ì°¨"
        contact: "secondary-oncall"
        timeout: "10ë¶„"
      - level: "3ì°¨"
        contact: "team-lead"
        timeout: "30ë¶„"
      - level: "4ì°¨"
        contact: "cto"
        timeout: "1ì‹œê°„"

  # ì¸ì‹œë˜íŠ¸ ëŒ€ì‘ ì—­í•  ì •ì˜
  incidentRoles:
    - role: "Incident Commander (IC)"
      description: "ì¸ì‹œë˜íŠ¸ ëŒ€ì‘ ì´ê´„ ë° ì˜ì‚¬ê²°ì •"
      responsibilities:
        - "ì¸ì‹œë˜íŠ¸ ìƒí™© íŒŒì•… ë° ìš°ì„ ìˆœìœ„ ê²°ì •"
        - "ëŒ€ì‘ íŒ€ êµ¬ì„± ë° ì—­í•  ë¶„ë‹´"
        - "ìŠ¤í…Œì´í¬í™€ë”ì™€ì˜ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜"
        - "ì¸ì‹œë˜íŠ¸ í•´ê²° í›„ íŒ€ í•´ì‚°"
      skills:
        - "ìƒí™© íŒë‹¨ ëŠ¥ë ¥"
        - "ì˜ì‚¬ê²°ì • ëŠ¥ë ¥"
        - "ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ëŠ¥ë ¥"

    - role: "Operations Lead"
      description: "ê¸°ìˆ ì  ë¬¸ì œ í•´ê²° ë° ë³µêµ¬ ì‘ì—… ì´ê´„"
      responsibilities:
        - "ê¸°ìˆ ì  ë¬¸ì œ ì§„ë‹¨ ë° í•´ê²° ë°©ì•ˆ ìˆ˜ë¦½"
        - "ë³µêµ¬ ì‘ì—… ê³„íš ë° ì‹¤í–‰"
        - "ê¸°ìˆ íŒ€ê³¼ì˜ í˜‘ì—… ì¡°ìœ¨"
        - "ë³µêµ¬ ì§„í–‰ ìƒí™© ë³´ê³ "
      skills:
        - "ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ì´í•´"
        - "ë¬¸ì œ í•´ê²° ëŠ¥ë ¥"
        - "ê¸°ìˆ ì  ì „ë¬¸ì„±"

    - role: "Communications Lead"
      description: "ë‚´ë¶€/ì™¸ë¶€ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ë° ìƒíƒœ ì—…ë°ì´íŠ¸"
      responsibilities:
        - "ì¸ì‹œë˜íŠ¸ ìƒíƒœ í˜ì´ì§€ ì—…ë°ì´íŠ¸"
        - "ê³ ê° ì§€ì›íŒ€ê³¼ì˜ ì—°ë½"
        - "ë‚´ë¶€ íŒ€ ê°„ ì •ë³´ ê³µìœ "
        - "ë§¤ì²´/ì†Œì…œë¯¸ë””ì–´ ëŒ€ì‘"
      skills:
        - "ëª…í™•í•œ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜"
        - "ìœ„ê¸° ì»¤ë®¤ë‹ˆì¼€ì´ì…˜"
        - "ìŠ¤í…Œì´í¬í™€ë” ê´€ë¦¬"

    - role: "Liaison"
      description: "ì™¸ë¶€ íŒ€/ì¡°ì§ê³¼ì˜ ì—°ë½ ë° í˜‘ì—… ì¡°ìœ¨"
      responsibilities:
        - "í´ë¼ìš°ë“œ ì œê³µì—…ì²´ì™€ì˜ ì—°ë½"
        - "CDN/ë„¤íŠ¸ì›Œí¬ ì œê³µì—…ì²´ì™€ì˜ í˜‘ì—…"
        - "ë³´ì•ˆíŒ€ê³¼ì˜ ì—°ë½"
        - "ë²•ë¬´íŒ€ê³¼ì˜ í˜‘ì—…"
      skills:
        - "ì™¸ë¶€ ì¡°ì§ê³¼ì˜ í˜‘ì—…"
        - "ê³„ì•½/ì„œë¹„ìŠ¤ ë ˆë²¨ ì´í•´"
        - "í˜‘ìƒ ëŠ¥ë ¥"

    - role: "Scribe"
      description: "ì¸ì‹œë˜íŠ¸ íƒ€ì„ë¼ì¸ ë° í™œë™ ê¸°ë¡"
      responsibilities:
        - "ì¸ì‹œë˜íŠ¸ íƒ€ì„ë¼ì¸ ì‘ì„±"
        - "ëª¨ë“  í™œë™ ë° ê²°ì •ì‚¬í•­ ê¸°ë¡"
        - "ì¦ê±° ìˆ˜ì§‘ ë° ë³´ê´€"
        - "í¬ìŠ¤íŠ¸ëª¨í…œ ìë£Œ ì¤€ë¹„"
      skills:
        - "ì •í™•í•œ ê¸°ë¡ ëŠ¥ë ¥"
        - "ê°ê´€ì  ê´€ì°°"
        - "ë¬¸ì„œí™” ëŠ¥ë ¥"

  # ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ì •ì±…
  communicationPolicy:
    internal:
      channels:
        - name: "game-sre-incident"
          type: "slack"
          purpose: "ì¸ì‹œë˜íŠ¸ ëŒ€ì‘ íŒ€ ê°„ ì†Œí†µ"
          access: "game-sre-team"

        - name: "game-ops-alerts"
          type: "slack"
          purpose: "ìš´ì˜íŒ€ ì•Œë¦¼ ë° í˜‘ì—…"
          access: "game-ops-team"

        - name: "game-dev-incident"
          type: "slack"
          purpose: "ê°œë°œíŒ€ í˜‘ì—… ë° ê¸°ìˆ  ì§€ì›"
          access: "game-dev-team"

    external:
      channels:
        - name: "status-page"
          type: "web"
          purpose: "ê³ ê° ê³µì§€ ë° ì„œë¹„ìŠ¤ ìƒíƒœ"
          access: "public"

        - name: "customer-support"
          type: "email"
          purpose: "ê³ ê° ë¬¸ì˜ ì‘ëŒ€"
          access: "customer-support-team"

        - name: "media-relations"
          type: "phone"
          purpose: "ë§¤ì²´ ë¬¸ì˜ ëŒ€ì‘"
          access: "pr-team"

    templates:
      status_update: |
        ğŸš¨ [{{.Severity}}] {{.Service}} ì¸ì‹œë˜íŠ¸ ë°œìƒ

        **ìƒí™©**: {{.Description}}
        **ì˜í–¥**: {{.Impact}}
        **ì§„í–‰ìƒí™©**: {{.Status}}
        **ì˜ˆìƒ í•´ê²°ì‹œê°„**: {{.ETA}}

        ìì„¸í•œ ë‚´ìš©ì€ ìƒíƒœí˜ì´ì§€ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.

      resolution_notice: |
        âœ… [RESOLVED] {{.Service}} ì¸ì‹œë˜íŠ¸ í•´ê²°

        **í•´ê²°ì‹œê°„**: {{.ResolutionTime}}
        **ì›ì¸**: {{.RootCause}}
        **ì¡°ì¹˜ì‚¬í•­**: {{.Actions}}

        ì •ìƒ ì„œë¹„ìŠ¤ê°€ ì¬ê°œë˜ì—ˆìŠµë‹ˆë‹¤.

  # ì—ìŠ¤ì»¬ë ˆì´ì…˜ ì •ì±…
  escalationPolicy:
    automatic:
      - condition: "Sev0 ì¸ì‹œë˜íŠ¸ ë°œìƒ"
        action: "ì¦‰ì‹œ CTO ë° ëª¨ë“  íŒ€ ë¦¬ë“œì—ê²Œ ì•Œë¦¼"
        timeout: "0ë¶„"

      - condition: "Sev1 ì¸ì‹œë˜íŠ¸ 15ë¶„ ë¯¸í•´ê²°"
        action: "íŒ€ ë¦¬ë“œì—ê²Œ ì—ìŠ¤ì»¬ë ˆì´ì…˜"
        timeout: "15ë¶„"

      - condition: "Sev2 ì¸ì‹œë˜íŠ¸ 1ì‹œê°„ ë¯¸í•´ê²°"
        action: "íŒ€ ë¦¬ë“œì—ê²Œ ì—ìŠ¤ì»¬ë ˆì´ì…˜"
        timeout: "1ì‹œê°„"

      - condition: "Sev3 ì¸ì‹œë˜íŠ¸ 4ì‹œê°„ ë¯¸í•´ê²°"
        action: "íŒ€ ë¦¬ë“œì—ê²Œ ì—ìŠ¤ì»¬ë ˆì´ì…˜"
        timeout: "4ì‹œê°„"

    manual:
      - condition: "ê¸°ìˆ ì  í•œê³„ ë„ë‹¬"
        action: "ì™¸ë¶€ ì „ë¬¸ê°€ ë˜ëŠ” ë²¤ë” ì§€ì› ìš”ì²­"

      - condition: "ë¹„ì¦ˆë‹ˆìŠ¤ ì˜í–¥ í™•ëŒ€"
        action: "ê²½ì˜ì§„ì—ê²Œ ì˜ì‚¬ê²°ì • ìš”ì²­"

      - condition: "ë³´ì•ˆ ì‚¬ê³  ì˜ì‹¬"
        action: "ë³´ì•ˆíŒ€ ë° ë²•ë¬´íŒ€ì— ì¦‰ì‹œ ë³´ê³ "

  # ì¸ì‹œë˜íŠ¸ ë¶„ë¥˜ ì²´ê³„
  incidentClassification:
    categories:
      - name: "infrastructure"
        description: "ì¸í”„ë¼ ê´€ë ¨ ì¥ì• "
        examples:
          - "ì„œë²„ ë‹¤ìš´"
          - "ë„¤íŠ¸ì›Œí¬ ì¥ì• "
          - "ìŠ¤í† ë¦¬ì§€ ë¬¸ì œ"

      - name: "application"
        description: "ì• í”Œë¦¬ì¼€ì´ì…˜ ì†Œí”„íŠ¸ì›¨ì–´ ì¥ì• "
        examples:
          - "ì½”ë“œ ë²„ê·¸"
          - "ë©”ëª¨ë¦¬ ëˆ„ìˆ˜"
          - "ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ì˜¤ë¥˜"

      - name: "deployment"
        description: "ë°°í¬ ê´€ë ¨ ì¥ì• "
        examples:
          - "ë¡¤ë°± ì‹¤íŒ¨"
          - "ì„¤ì • ì˜¤ë¥˜"
          - "ì˜ì¡´ì„± ë¬¸ì œ"

      - name: "security"
        description: "ë³´ì•ˆ ê´€ë ¨ ì‚¬ê³ "
        examples:
          - "DDoS ê³µê²©"
          - "ë°ì´í„° ìœ ì¶œ"
          - "ê¶Œí•œ ì˜¤ë¥˜"

      - name: "performance"
        description: "ì„±ëŠ¥ ì €í•˜"
        examples:
          - "ì‘ë‹µ ì§€ì—°"
          - "ì²˜ë¦¬ëŸ‰ ì €í•˜"
          - "ë¦¬ì†ŒìŠ¤ ë¶€ì¡±"

    tags:
      - "game-server"
      - "matchmaking"
      - "data-persistence"
      - "payment"
      - "user-authentication"
      - "real-time-communication"

  # í¬ìŠ¤íŠ¸ëª¨í…œ ì •ì±…
  postmortemPolicy:
    required: "Sev0, Sev1 ì¸ì‹œë˜íŠ¸"
    optional: "Sev2, Sev3 ì¸ì‹œë˜íŠ¸"
    timeline: "ì¸ì‹œë˜íŠ¸ í•´ê²° í›„ 48ì‹œê°„ ë‚´"
    participants:
      - "Incident Commander"
      - "Operations Lead"
      - "ê´€ë ¨ ê¸°ìˆ  ë‹´ë‹¹ì"
      - "íŒ€ ë¦¬ë“œ"
      - "ë³´ì•ˆíŒ€ (ë³´ì•ˆ ì‚¬ê³  ì‹œ)"

    deliverables:
      - "ì¸ì‹œë˜íŠ¸ íƒ€ì„ë¼ì¸"
      - "ê·¼ë³¸ ì›ì¸ ë¶„ì„"
      - "ì˜í–¥ ë²”ìœ„ ë° ì†ì‹¤ í‰ê°€"
      - "êµí›ˆ ë° ê°œì„ ì "
      - "ì•¡ì…˜ ì•„ì´í…œ ë° ë‹´ë‹¹ì"
      - "ì¬ë°œ ë°©ì§€ ê³„íš"

    review:
      - "íŒ€ ì „ì²´ ë¦¬ë·°"
      - "ê²½ì˜ì§„ ë³´ê³ "
      - "ë¬¸ì„œí™” ë° ê³µìœ "
      - "í›ˆë ¨ ìë£Œ ì—…ë°ì´íŠ¸"

  # ì¸ì‹œë˜íŠ¸ ë©”íŠ¸ë¦­ ë° KPI
  incidentMetrics:
    primary:
      - name: "MTTD (Mean Time To Detection)"
        description: "ì¸ì‹œë˜íŠ¸ ë°œìƒë¶€í„° ê°ì§€ê¹Œì§€ì˜ í‰ê·  ì‹œê°„"
        target: "Sev0: 1ë¶„, Sev1: 5ë¶„, Sev2: 15ë¶„, Sev3: 30ë¶„"
        unit: "ë¶„"

      - name: "MTTR (Mean Time To Resolution)"
        description: "ì¸ì‹œë˜íŠ¸ ê°ì§€ë¶€í„° í•´ê²°ê¹Œì§€ì˜ í‰ê·  ì‹œê°„"
        target: "Sev0: 15ë¶„, Sev1: 30ë¶„, Sev2: 2ì‹œê°„, Sev3: 4ì‹œê°„"
        unit: "ë¶„"

      - name: "MTBF (Mean Time Between Failures)"
        description: "ì¸ì‹œë˜íŠ¸ ê°„ í‰ê·  ê°„ê²©"
        target: "ì›” 1íšŒ ë¯¸ë§Œ"
        unit: "ì¼"

    secondary:
      - name: "ì¸ì‹œë˜íŠ¸ ë¹ˆë„"
        description: "ë‹¨ìœ„ ì‹œê°„ë‹¹ ì¸ì‹œë˜íŠ¸ ë°œìƒ íšŸìˆ˜"
        target: "ì›” 5íšŒ ë¯¸ë§Œ"
        unit: "íšŒ/ì›”"

      - name: "ì¬ë°œë¥ "
        description: "ë™ì¼í•œ ì›ì¸ìœ¼ë¡œ ì¬ë°œí•œ ì¸ì‹œë˜íŠ¸ ë¹„ìœ¨"
        target: "10% ë¯¸ë§Œ"
        unit: "í¼ì„¼íŠ¸"

      - name: "ê³ ê° ë§Œì¡±ë„"
        description: "ì¸ì‹œë˜íŠ¸ ëŒ€ì‘ì— ëŒ€í•œ ê³ ê° ë§Œì¡±ë„"
        target: "4.0/5.0 ì´ìƒ"
        unit: "ì ìˆ˜"

  # ì¸ì‹œë˜íŠ¸ ëŒ€ì‘ ë„êµ¬ ë° ìë™í™”
  toolsAndAutomation:
    monitoring:
      - name: "Prometheus + Grafana"
        purpose: "ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° ì‹œê°í™”"
        integration: "ìë™ ì•Œë¦¼ ë° ëŒ€ì‹œë³´ë“œ"

      - name: "AlertManager"
        purpose: "ì•Œë¦¼ ë¼ìš°íŒ… ë° ê·¸ë£¹í•‘"
        integration: "Slack, PagerDuty ì—°ë™"

    communication:
      - name: "Slack"
        purpose: "íŒ€ ê°„ ì‹¤ì‹œê°„ ì†Œí†µ"
        integration: "ì•Œë¦¼ ë´‡, ì›Œí¬í”Œë¡œìš°"

      - name: "StatusPage"
        purpose: "ê³ ê° ê³µì§€ ë° ìƒíƒœ ì—…ë°ì´íŠ¸"
        integration: "ìë™ ìƒíƒœ ì—…ë°ì´íŠ¸"

    documentation:
      - name: "Confluence/Notion"
        purpose: "ì¸ì‹œë˜íŠ¸ ë¬¸ì„œí™” ë° ì§€ì‹ ê´€ë¦¬"
        integration: "í…œí”Œë¦¿ ë° ìë™í™”"

      - name: "Jira/Linear"
        purpose: "ì•¡ì…˜ ì•„ì´í…œ ì¶”ì "
        integration: "ìë™ í‹°ì¼“ ìƒì„±"

    automation:
      - name: "Runbook ìë™í™”"
        purpose: "ë°˜ë³µ ì‘ì—… ìë™í™”"
        integration: "ChatOps ëª…ë ¹ì–´"

      - name: "ë³µêµ¬ ìŠ¤í¬ë¦½íŠ¸"
        purpose: "ì¼ë°˜ì ì¸ ë¬¸ì œ ìë™ ë³µêµ¬"
        integration: "Prometheus ê·œì¹™ ì—°ë™"

  # ì¸ì‹œë˜íŠ¸ ëŒ€ì‘ í›ˆë ¨ ë° êµìœ¡
  trainingAndEducation:
    frequency: "ë¶„ê¸°ë³„"
    participants: "ì „ì²´ SRE íŒ€"
    format:
      - "í…Œì´ë¸”í†± ì—°ìŠµ"
      - "ì‹¤ì œ ì‹œìŠ¤í…œì„ ì´ìš©í•œ ì‹œë®¬ë ˆì´ì…˜"
      - "ì—­í• ê·¹ ë° ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë°˜ í›ˆë ¨"

    topics:
      - "ì¸ì‹œë˜íŠ¸ ëŒ€ì‘ ì ˆì°¨"
      - "ë„êµ¬ ì‚¬ìš©ë²•"
      - "ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ìŠ¤í‚¬"
      - "ë¬¸ì œ í•´ê²° ê¸°ë²•"
      - "í¬ìŠ¤íŠ¸ëª¨í…œ ì‘ì„±ë²•"

    evaluation:
      - "í›ˆë ¨ ì„±ê³¼ ì¸¡ì •"
      - "ê°œì„ ì  ì‹ë³„"
      - "í›ˆë ¨ ìë£Œ ì—…ë°ì´íŠ¸"
      - "ì—­í•  ë° ì±…ì„ ëª…í™•í™”"
